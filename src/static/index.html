<!DOCTYPE html>
<html>
<head>
    <title>Ollama LLM Interface</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        #responseArea { white-space: pre-wrap; word-wrap: break-word; }
        .timer { color: #666; font-size: 0.9em; }
        #modelSelector {
            margin-top: 20px;
        }
        .model-option {
            padding: 5px;
            cursor: pointer;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ollama LLM Interface</h1>
        <form id="promptForm" onsubmit="handleSubmit(event)">
            <textarea id="promptInput" rows="4" placeholder="Enter your prompt here..."></textarea><br>
            <button type="submit">Generate</button>
        </form>
        <div id="modelSelector">
            <h3>Select Model:</h3>
            <select id="selectedModel" style="width: 200px;">
                <!-- Models will be populated here -->
            </select>
        </div>
        <div id="responseArea"></div>
        <div class="timer" id="timer"></div>
    </div>

    <script>
function handleSubmit(event) {
    event.preventDefault();
    const promptInput = document.getElementById('promptInput');
    const responseArea = document.getElementById('responseArea');
    const timer = document.getElementById('timer');
    const selectedModel = document.getElementById('selectedModel').value;

    responseArea.innerHTML = "Generating response...";
    timer.innerHTML = "";

    const startTime = new Date().getTime();

    fetch('/api/generate', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: `model=${encodeURIComponent(selectedModel)}&prompt=${encodeURIComponent(promptInput.value)}`,
    })
    .then(response => {
        if (!response.ok) throw new Error("Server error");
        return response.json();
    })
    .then(data => {
        const endTime = new Date().getTime();
        const duration = (endTime - startTime) / 1000;
        responseArea.textContent = data.text;
        timer.innerHTML = `Generation took: ${duration.toFixed(2)} seconds`;
    })
    .catch(error => {
        console.error('Error:', error);
        responseArea.textContent = 'Error generating response';
    });

    promptInput.value = '';
}

function initModelSelector() {
    fetch('/api/tags')
        .then(response => response.json())
        .then(models => {
            const modelSelect = document.getElementById('selectedModel');
            modelSelect.innerHTML = "";
            models.forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                modelSelect.appendChild(option);
            });
        })
        .catch(error => console.error('Error fetching models:', error));
}

document.addEventListener('DOMContentLoaded', initModelSelector);
</script>
</body>
</html>